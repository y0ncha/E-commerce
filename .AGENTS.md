# AGENTS.md - Work Methodology & Protocol

## 0. Project Context
* **Assignment:** EDA Course (MTA) - Exercise 2.
* **Tech Stack:** Spring Boot, Apache Kafka, Docker.
* **Goal:** Demonstrate Kafka-specific patterns: Message Keying, Ordering Guarantees, and Manual Offset Commits.
* **Simplicity:** Prioritize straightforward, educational implementations over "production-grade" over-engineering.

## 1. Project Goal & Scope
* **Active Target:** **Exercise 2 (Kafka)**.
* **Legacy Context:** Exercise 1 (RabbitMQ) is for reference only. **DO NOT** use RabbitMQ terminology (Exchanges/Routing Keys). Use Kafka terms (Topics/Partitions).

## 2. Operational Protocol
* **Contextual Roadmap:** Always refer to the service-specific plan: `producer/docs/PLAN.md` or `consumer/docs/PLAN.md`.
* **Requirement Check:** Consult `Ex.02.md` before any implementation.
* **Step-by-Step:** Break tasks into discrete steps (e.g., "Step 1: Kafka Properties"). Wait for user confirmation before proceeding.
* **Approval Flow:** Provide a high-level plan for any code change, ensure it aligns with the relevant `PLAN.md`, and wait for a "Go".

## 3. Response Standards
* **Educational Justification:** Cite course sessions (e.g., *Session 6 - Consumer*) to explain architectural choices like manual commits.
* **Error Handling:** Focus on broker availability (HTTP 503/500) and data validation.
* **Conciseness:** Use bullet points and provide a **TL;DR summary** at the end.

## 4. Critical Kafka Safeguards
* **Message Key:** The `orderId` MUST be the Message Key in the Producer to guarantee partition-level ordering.
* **Manual Commits:** Consumers MUST set `EnableAutoCommit = false` and commit offsets manually to ensure "At-Least-Once" delivery.
* **Idempotency:** Ensure the Consumer handles potential duplicate messages gracefully.

## 5. Constraints
* **No New Tests:** Do not create new test files unless explicitly requested.
* **No New Documentation:** Do not create new markdown files unless explicitly requested. Update existing ones instead.