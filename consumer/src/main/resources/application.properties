spring.application.name=order-service
server.port=8082

# Kafka Configuration
spring.kafka.bootstrap-servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
spring.kafka.consumer.group-id=order-service-group
spring.kafka.consumer.auto-offset-reset=earliest

# Kafka Listener Auto-Startup Configuration
# Set to false so listeners are created but NOT started automatically during app initialization
# This allows the application to start WITHOUT Kafka being available
# KafkaConnectivityService will manually start listeners when Kafka becomes ready
spring.kafka.listener.auto-startup=false

# MANDATORY: Disable auto-commit to support manual offset management.
# This enables At-Least-Once delivery semantics by allowing the application
# to acknowledge offsets only after successful processing, preventing message loss.
spring.kafka.consumer.enable-auto-commit=false
# MANDATORY: Set listener acknowledgment mode to MANUAL_IMMEDIATE.
# This ensures offsets are committed immediately upon manual acknowledge() call,
# supporting strict message ordering guarantees for duplicate detection and sequencing.
spring.kafka.listener.ack-mode=manual_immediate

# Kafka Connection Timeouts (Optimized for fast startup and reconnection)
# Reduced from default 60s to 5s for faster failure detection
spring.kafka.properties.connections.max.idle.ms=5000
# Reduced session timeout from 45s to 10s for quicker broker failure detection
spring.kafka.consumer.properties.session.timeout.ms=10000
# Reduced heartbeat interval from 3s to 2s for faster liveness detection
spring.kafka.consumer.properties.heartbeat.interval.ms=2000
# Reduced metadata fetch timeout from 60s to 5s for faster startup
spring.kafka.consumer.properties.metadata.max.age.ms=5000
# Reduced request timeout from 30s to 10s for faster retry cycles
spring.kafka.consumer.properties.request.timeout.ms=10000

# Kafka Admin (Prevent startup failure if Kafka is down during tests)
spring.kafka.admin.fail-fast=false

# Consumer Topic (configurable via environment variable KAFKA_TOPIC)
kafka.consumer.topic=${KAFKA_TOPIC:orders}

# Logging
logging.level.root=INFO
logging.level.mta.eda.consumer=DEBUG

# Send 404s for unknown endpoints through ControllerAdvice
spring.web.resources.add-mappings=false
